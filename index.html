<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curso Rovers - Fundamentos Scout</title>
    <link rel="manifest" href="data:application/json,{&quot;name&quot;:&quot;Curso Rovers Scout&quot;,&quot;short_name&quot;:&quot;RoversCurso&quot;,&quot;start_url&quot;:&quot;/&quot;,&quot;display&quot;:&quot;standalone&quot;,&quot;background_color&quot;:&quot;#1a4b6b&quot;,&quot;theme_color&quot;:&quot;#1a4b6b&quot;}">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a4b6b 0%, #2d5a87 100%);
            color: #333;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        .header {
            background: linear-gradient(135deg, #1a4b6b 0%, #2d5a87 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .progress-container {
            background: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-bar {
            background: #ffd700;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .navigation {
            background: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .nav-btn {
            background: #1a4b6b;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .nav-btn:hover {
            background: #2d5a87;
            transform: translateY(-2px);
        }

        .nav-btn.active {
            background: #28a745;
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3);
        }

        .nav-btn.completed {
            background: #6c757d;
        }

        .content {
            padding: 30px;
            line-height: 1.6;
        }

        .module {
            display: none;
        }

        .module.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .module h2 {
            color: #1a4b6b;
            margin-bottom: 20px;
            font-size: 1.8rem;
            border-bottom: 3px solid #ffd700;
            padding-bottom: 10px;
        }

        .module h3 {
            color: #2d5a87;
            margin: 25px 0 15px 0;
            font-size: 1.3rem;
        }

        .badge {
            display: inline-block;
            background: #ffd700;
            color: #1a4b6b;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }

        .quiz-container {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 4px solid #1a4b6b;
        }

        .question {
            margin-bottom: 15px;
        }

        .question h4 {
            color: #1a4b6b;
            margin-bottom: 10px;
        }

        .option {
            display: block;
            margin: 8px 0;
            padding: 10px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            border-color: #1a4b6b;
            background: #f0f8ff;
        }

        .option.selected {
            border-color: #1a4b6b;
            background: #e3f2fd;
        }

        .option.correct {
            border-color: #28a745;
            background: #d4edda;
        }

        .option.incorrect {
            border-color: #dc3545;
            background: #f8d7da;
        }

        .btn {
            background: #1a4b6b;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            margin: 10px 5px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #2d5a87;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border: 1px solid #c3e6cb;
        }

        .info-box {
            background: #d1ecf1;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #17a2b8;
        }

        .reflection-area {
            background: #fff3cd;
            padding: 20px;
            border-radius: 5px;
            margin: 20px 0;
            border-left: 4px solid #ffc107;
        }

        .reflection-area textarea {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: inherit;
            resize: vertical;
        }

        .achievements {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .achievement {
            background: #e8f5e8;
            color: #2d5a2d;
            padding: 10px 15px;
            border-radius: 10px;
            border: 2px solid #28a745;
            font-size: 0.9rem;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .achievement.earned {
            opacity: 1;
            transform: scale(1.05);
        }

        .certificate {
            background: linear-gradient(45deg, #fff, #f8f9fa);
            border: 3px solid #ffd700;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
        }

        .certificate h3 {
            color: #1a4b6b;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #1a4b6b, #2d5a87);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .stat-card h4 {
            font-size: 2rem;
            margin-bottom: 5px;
        }

        .stat-card p {
            opacity: 0.9;
            font-size: 0.9rem;
        }

        .registration-form {
            background: linear-gradient(135deg, #e8f5e8, #c8e6c8);
            padding: 30px;
            border-radius: 15px;
            margin: 20px 0;
            border: 3px solid #28a745;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #1a4b6b;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #dee2e6;
            border-radius: 5px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #1a4b6b;
        }

        .mission-box {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            padding: 25px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #ff9800;
        }

        .mission-box h3 {
            color: #e65100;
            text-align: center;
            margin-bottom: 15px;
        }

        .education-concept {
            background: #f3e5f5;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            border-left: 4px solid #9c27b0;
        }

        .timeline {
            margin: 20px 0;
        }

        .timeline-item {
            background: #f8f9fa;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #1a4b6b;
            border-radius: 0 5px 5px 0;
        }

        .timeline-item h4 {
            color: #1a4b6b;
            margin-bottom: 5px;
        }

        .method-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .method-element {
            padding: 20px;
            border-radius: 12px;
            border: 2px solid;
            position: relative;
            transition: transform 0.3s ease;
        }

        .method-element:hover {
            transform: translateY(-5px);
        }

        .method-element h4 {
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .method-element p {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
            }
            
            .content {
                padding: 20px 15px;
            }
            
            .navigation {
                padding: 10px;
            }
            
            .nav-btn {
                font-size: 0.8rem;
                padding: 8px 12px;
            }
            
            .header h1 {
                font-size: 1.5rem;
            }
        }

        .hidden {
            display: none !important;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏕️ Curso Rovers - Fundamentos Scout</h1>
            <p>Historia y Características Esenciales del Movimiento Scout</p>
            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>
            <div style="margin-top: 10px; font-size: 0.9rem;">
                Progreso: <span id="progressText">0%</span> | 
                Tiempo estimado: <span id="timeRemaining">5 horas</span>
            </div>
        </div>

        <div class="navigation">
            <button class="nav-btn active" onclick="showModule(0)">📝 Registro</button>
            <button class="nav-btn" onclick="showModule(1)">🏠 Inicio</button>
            <button class="nav-btn" onclick="showModule(2)">🎯 Misión</button>
            <button class="nav-btn" onclick="showModule(3)">⛰️ Mafeking</button>
            <button class="nav-btn" onclick="showModule(4)">🏝️ Brownsea</button>
            <button class="nav-btn" onclick="showModule(5)">🌍 Expansión</button>
            <button class="nav-btn" onclick="showModule(6)">⚙️ Método Scout</button>
            <button class="nav-btn" onclick="showModule(7)">🎯 Impacto</button>
            <button class="nav-btn" onclick="showModule(8)">🏆 Certificado</button>
        </div>

        <div class="content">
            <!-- MÓDULO 0: REGISTRO -->
            <div class="module active" id="module-0">
                <h2>📝 Registro al Curso</h2>
                
                <div class="registration-form">
                    <h3 style="text-align: center; margin-bottom: 25px; color: #1a4b6b;">
                        🏕️ Bienvenido/a al Curso de Fundamentos Scout
                    </h3>
                    
                    <p style="text-align: center; margin-bottom: 25px;">
                        Para comenzar tu aventura educativa scout, por favor completa la siguiente información:
                    </p>

                    <form id="registrationForm" onsubmit="handleRegistration(event)">
                        <div class="form-group">
                            <label for="fullName">Nombre Completo *</label>
                            <input type="text" id="fullName" name="fullName" required 
                                   placeholder="Ej: Juan Carlos Pérez Gómez">
                        </div>

                        <div class="form-group">
                            <label for="age">Edad</label>
                            <input type="number" id="age" name="age" min="16" max="25" 
                                   placeholder="Ej: 19">
                        </div>

                        <div class="form-group">
                            <label for="group">Grupo Scout</label>
                            <input type="text" id="group" name="group" 
                                   placeholder="Ej: Grupo Scout 25 Bogotá">
                        </div>

                        <div class="form-group">
                            <label for="region">Región/Departamento</label>
                            <select id="region" name="region">
                                <option value="">Selecciona tu región</option>
                                <option value="Amazonas">Amazonas</option>
                                <option value="Antioquia">Antioquia</option>
                                <option value="Arauca">Arauca</option>
                                <option value="Atlántico">Atlántico</option>
                                <option value="Bolívar">Bolívar</option>
                                <option value="Boyacá">Boyacá</option>
                                <option value="Caldas">Caldas</option>
                                <option value="Caquetá">Caquetá</option>
                                <option value="Casanare">Casanare</option>
                                <option value="Cauca">Cauca</option>
                                <option value="Cesar">Cesar</option>
                                <option value="Chocó">Chocó</option>
                                <option value="Córdoba">Córdoba</option>
                                <option value="Cundinamarca">Cundinamarca</option>
                                <option value="Guainía">Guainía</option>
                                <option value="Guaviare">Guaviare</option>
                                <option value="Huila">Huila</option>
                                <option value="La Guajira">La Guajira</option>
                                <option value="Magdalena">Magdalena</option>
                                <option value="Meta">Meta</option>
                                <option value="Nariño">Nariño</option>
                                <option value="Norte de Santander">Norte de Santander</option>
                                <option value="Putumayo">Putumayo</option>
                                <option value="Quindío">Quindío</option>
                                <option value="Risaralda">Risaralda</option>
                                <option value="San Andrés y Providencia">San Andrés y Providencia</option>
                                <option value="Santander">Santander</option>
                                <option value="Sucre">Sucre</option>
                                <option value="Tolima">Tolima</option>
                                <option value="Valle del Cauca">Valle del Cauca</option>
                                <option value="Vaupés">Vaupés</option>
                                <option value="Vichada">Vichada</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="email">Correo Electrónico</label>
                            <input type="email" id="email" name="email" 
                                   placeholder="Ej: juan.perez@email.com">
                        </div>

                        <div class="form-group">
                            <label for="motivation">¿Por qué quieres ser sinodal/ayudante?</label>
                            <textarea id="motivation" name="motivation" rows="4" 
                                     placeholder="Describe brevemente tu motivación para apoyar en manada o tropa..."></textarea>
                        </div>

                        <div style="text-align: center; margin-top: 30px;">
                            <button type="submit" class="btn" style="font-size: 1.1rem; padding: 15px 30px;">
                                🚀 Comenzar Curso
                            </button>
                        </div>
                    </form>
                </div>

                <div class="info-box">
                    <strong>📊 Al completar el registro:</strong><br>
                    • Tu progreso se guardará automáticamente<br>
                    • Recibirás un certificado personalizado al finalizar<br>
                    • Podrás continuar el curso desde donde lo dejaste<br>
                    • Los datos solo se usan para personalizar tu experiencia
                </div>
            </div>

            <!-- MÓDULO 1: INICIO -->
            <div class="module" id="module-1">
                <h2>🏠 Bienvenido/a <span id="welcomeName"></span></h2>
                
                <div class="info-box">
                    <strong>¡Siempre Listo/a para Servir!</strong><br>
                    Estás a punto de embarcarte en un viaje educativo que te preparará para transmitir el legado scout a las nuevas generaciones.
                </div>

                <h3>🎯 Objetivos del Curso</h3>
                <ul>
                    <li><strong>Conocer la misión y propósito</strong> del movimiento scout mundial</li>
                    <li><strong>Comprender los orígenes históricos</strong> del movimiento scout</li>
                    <li><strong>Dominar las características esenciales</strong> del escultismo</li>
                    <li><strong>Entender los 8 elementos</strong> del método scout correctamente</li>
                    <li><strong>Fortalecer conceptos educativos</strong> scouts aplicables a niños y niñas</li>
                    <li><strong>Prepararte para ser sinodal/ayudante</strong> en manada y tropa</li>
                </ul>

                <h3>🏆 Logros por Desbloquear</h3>
                <div class="achievements">
                    <div class="achievement" id="achievement-1">📚 Historiador Scout</div>
                    <div class="achievement" id="achievement-2">🎯 Conocedor de la Misión</div>
                    <div class="achievement" id="achievement-3">⚙️ Metodólogo Scout</div>
                    <div class="achievement" id="achievement-4">🌍 Ciudadano Global</div>
                    <div class="achievement" id="achievement-5">🎓 Rover Certificado</div>
                </div>

                <div class="stats">
                    <div class="stat-card">
                        <h4 id="modulesCompleted">0</h4>
                        <p>Módulos Completados</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="quizzesCompleted">0</h4>
                        <p>Evaluaciones Aprobadas</p>
                    </div>
                    <div class="stat-card">
                        <h4 id="studyTime">0</h4>
                        <p>Minutos de Estudio</p>
                    </div>
                </div>

                <button class="btn" onclick="showModule(2)">🚀 Comenzar con la Misión Scout</button>
            </div>

            <!-- MÓDULO 2: MISIÓN Y PROPÓSITO -->
            <div class="module" id="module-2">
                <h2>🎯 Misión y Propósito del Movimiento Scout</h2>
                
                <div class="badge">Módulo 1/6</div>
                
                <div class="mission-box">
                    <h3>🌟 MISIÓN DEL MOVIMIENTO SCOUT</h3>
                    <blockquote style="font-size: 1.1rem; font-style: italic; text-align: center; margin: 20px 0; color: #1a4b6b;">
                        "Contribuir a la educación de los jóvenes para que participen en la construcción de un mundo mejor, donde las personas se desarrollen plenamente y jueguen un papel constructivo en la sociedad."
                    </blockquote>
                    <p style="text-align: center; font-weight: bold; color: #e65100;">
                        - Conferencia Scout Mundial, 1999
                    </p>
                </div>

                <h3>🔍 ¿Cómo se logra esta misión?</h3>
                <div class="education-concept">
                    <p><strong>Mediante un sistema de valores basado en principios espirituales, sociales y personales</strong>, que se expresan en la Ley y la Promesa, aplicando el <strong>método scout</strong>, que convierte al joven en el <strong>principal agente de su desarrollo</strong>, de manera que llegue a ser una persona <strong>autónoma, solidaria, responsable y comprometida</strong>.</p>
                </div>

                <h3>🎓 El Enfoque Educativo Scout</h3>
                <p>El Movimiento Scout contribuye al desarrollo integral de los jóvenes en cinco dimensiones:</p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>💪 Física</h4>
                        <p>Desarrollo del cuerpo y habilidades físicas</p>
                    </div>
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>🧠 Intelectual</h4>
                        <p>Estimulación de la creatividad y pensamiento crítico</p>
                    </div>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>❤️ Emocional</h4>
                        <p>Orientación de los afectos y inteligencia emocional</p>
                    </div>
                    <div style="background: #fce4ec; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>🤝 Social</h4>
                        <p>Sentido de los otros y vida en comunidad</p>
                    </div>
                    <div style="background: #f3e5f5; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>🙏 Espiritual</h4>
                        <p>Encuentro con la trascendencia y valores profundos</p>
                    </div>
                </div>

                <div class="reflection-area">
                    <h4>🤔 Reflexión Personal</h4>
                    <p>¿Cómo has experimentado este desarrollo integral en tu vida scout? ¿En qué dimensión sientes que has crecido más?</p>
                    <textarea id="reflection-2" placeholder="Escribe tu reflexión aquí..." onchange="saveReflection(2, this.value)"></textarea>
                </div>

                <div class="quiz-container">
                    <h3>🔍 Evaluación - Misión y Propósito</h3>
                    <div class="question">
                        <h4>1. ¿Cuál es la misión del Movimiento Scout según la Conferencia Scout Mundial?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q1" style="margin-right: 10px;">
                            Enseñar técnicas de campismo y vida al aire libre
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q1" style="margin-right: 10px;">
                            Contribuir a la educación de los jóvenes para que participen en la construcción de un mundo mejor
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q1" style="margin-right: 10px;">
                            Formar jóvenes disciplinados y obedientes
                        </label>
                    </div>
                    
                    <div class="question">
                        <h4>2. ¿Cuántas dimensiones de desarrollo integral propone el escultismo?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q2" style="margin-right: 10px;">
                            3 dimensiones (física, mental, espiritual)
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q2" style="margin-right: 10px;">
                            5 dimensiones (física, intelectual, emocional, social, espiritual)
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q2" style="margin-right: 10px;">
                            4 dimensiones (física, mental, social, moral)
                        </label>
                    </div>

                    <button class="btn" onclick="checkQuiz(2, 2)" id="checkBtn-2">Verificar Respuestas</button>
                    <button class="btn hidden" onclick="completeModule(2)" id="nextBtn-2">Continuar a Mafeking ⛰️</button>
                </div>
            </div>

            <!-- MÓDULO 3: MAFEKING -->
            <div class="module" id="module-3">
                <h2>⛰️ Mafeking - El Nacimiento del Escultismo</h2>
                
                <div class="badge">Módulo 2/6</div>
                
                <h3>🏰 El Sitio de Mafeking (1899-1900)</h3>
                <p>Durante la Guerra de los Bóers, en la ciudad sudafricana de Mafeking, un coronel británico llamado Robert Baden-Powell vivió una experiencia que cambiaría para siempre la educación juvenil mundial.</p>

                <h3>👦 Los Jóvenes Héroes</h3>
                <p>Niños y jóvenes de la ciudad colaboraron voluntariamente con Baden-Powell en servicios esenciales:</p>
                <ul>
                    <li><strong>Mensajería:</strong> Llevaban comunicaciones importantes entre sectores</li>
                    <li><strong>Vigilancia:</strong> Actuaban como observadores y centinelas</li>
                    <li><strong>Primeros auxilios:</strong> Asistían en el cuidado de heridos</li>
                    <li><strong>Servicios de apoyo:</strong> Ayudaban en cocinas y distribución de suministros</li>
                </ul>

                <div class="info-box">
                    <strong>💡 Insight de Baden-Powell:</strong><br>
                    "Me di cuenta de que los jóvenes eran capaces de mucho más de lo que los adultos imaginábamos. Su entusiasmo, valentía y sentido del deber superaron todas las expectativas."
                </div>

                <h3>🎯 El Nacimiento del Concepto de Servicio</h3>
                <p>La experiencia de Mafeking determinó que <strong>el compromiso con los demás</strong> fuera uno de los valores más apreciados del escultismo.</p>
                
                <blockquote style="background: #f8f9fa; padding: 20px; border-left: 4px solid #1a4b6b; font-style: italic; margin: 20px 0;">
                    "El verdadero éxito es la felicidad y la mejor forma de ser feliz es hacer felices a los demás."
                    <br><small>- Robert Baden-Powell</small>
                </blockquote>

                <div class="reflection-area">
                    <h4>🤔 Reflexión Personal</h4>
                    <p>¿Cómo has experimentado la felicidad a través del servicio a otros? ¿Qué situaciones de tu vida scout reflejan este principio de Mafeking?</p>
                    <textarea id="reflection-3" placeholder="Escribe tu reflexión aquí..." onchange="saveReflection(3, this.value)"></textarea>
                </div>

                <div class="quiz-container">
                    <h3>🔍 Evaluación - Mafeking</h3>
                    <div class="question">
                        <h4>1. ¿En qué conflicto tuvo lugar el sitio de Mafeking?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q3" style="margin-right: 10px;">
                            Primera Guerra Mundial
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q3" style="margin-right: 10px;">
                            Guerra de los Bóers
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q3" style="margin-right: 10px;">
                            Guerra de Crimea
                        </label>
                    </div>
                    
                    <div class="question">
                        <h4>2. ¿Cuál fue la principal lección educativa que Baden-Powell aprendió en Mafeking?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q4" style="margin-right: 10px;">
                            Los jóvenes necesitan supervisión constante de adultos
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q4" style="margin-right: 10px;">
                            Los jóvenes son capaces de mucho más de lo que se imagina y el servicio genera felicidad
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q4" style="margin-right: 10px;">
                            La disciplina militar es esencial para educar jóvenes
                        </label>
                    </div>

                    <button class="btn" onclick="checkQuiz(3, 2)" id="checkBtn-3">Verificar Respuestas</button>
                    <button class="btn hidden" onclick="completeModule(3)" id="nextBtn-3">Continuar a Brownsea Island 🏝️</button>
                </div>
            </div>

            <!-- MÓDULO 4: BROWNSEA ISLAND -->
            <div class="module" id="module-4">
                <h2>🏝️ Brownsea Island - El Primer Campamento</h2>
                
                <div class="badge">Módulo 3/6</div>
                
                <h3>📅 Agosto 1-9, 1907</h3>
                <p>Años después de Mafeking, Baden-Powell decidió poner a prueba sus ideas educativas. Organizó un campamento experimental en Brownsea Island, una pequeña isla en la costa sur de Inglaterra.</p>

                <div class="timeline">
                    <div class="timeline-item">
                        <h4>🎯 La Preparación</h4>
                        <p>Baden-Powell invitó a 22 jóvenes de diferentes clases sociales, de 9 a 16 años, para probar su método educativo revolucionario.</p>
                    </div>
                    <div class="timeline-item">
                        <h4>⛺ El Campamento</h4>
                        <p>Durante 9 días, los jóvenes vivieron al aire libre, organizados en patrullas con nombres de animales: Lobos, Toros, Cuervos y Chorlitos.</p>
                    </div>
                    <div class="timeline-item">
                        <h4>🎓 Las Innovaciones</h4>
                        <p>Se implementaron técnicas revolucionarias que formarían la base del método scout mundial.</p>
                    </div>
                </div>

                <h3>🔥 Innovaciones Pedagógicas Revolucionarias</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px;">
                        <h4>🐺 Sistema de Patrullas</h4>
                        <p>Pequeños grupos de 6-8 jóvenes con identidad propia, liderazgo rotativo y responsabilidades compartidas.</p>
                    </div>
                    <div style="background: #e3f2fd; padding: 15px; border-radius: 8px;">
                        <h4>🌲 Vida al Aire Libre</h4>
                        <p>La naturaleza como aula de aprendizaje integral - laboratorio, club y templo según Baden-Powell.</p>
                    </div>
                    <div style="background: #fff3e0; padding: 15px; border-radius: 8px;">
                        <h4>🎯 Educación por la Acción</h4>
                        <p>Aprender haciendo, experimentando, vivenciando - no solo escuchando o memorizando.</p>
                    </div>
                    <div style="background: #fce4ec; padding: 15px; border-radius: 8px;">
                        <h4>👑 Liderazgo Juvenil</h4>
                        <p>Los jóvenes asumen responsabilidades reales, toman decisiones y lideran a sus pares.</p>
                    </div>
                </div>

                <div class="info-box">
                    <strong>📖 Resultado Histórico:</strong><br>
                    Basándose en esta experiencia exitosa, Baden-Powell escribió "Escultismo para Muchachos" en 1908, el libro que daría origen al movimiento scout mundial y se convertiría en el cuarto libro más vendido de la historia.
                </div>

                <div class="reflection-area">
                    <h4>🤔 Reflexión Personal</h4>
                    <p>¿Qué elementos del campamento de Brownsea reconoces en tu experiencia scout actual? ¿Cómo aplicarías estos principios con los niños y niñas que acompañarás?</p>
                    <textarea id="reflection-4" placeholder="Escribe tu reflexión aquí..." onchange="saveReflection(4, this.value)"></textarea>
                </div>

                <div class="quiz-container">
                    <h3>🔍 Evaluación - Brownsea Island</h3>
                    <div class="question">
                        <h4>1. ¿Cuántos jóvenes participaron en el primer campamento de Brownsea?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q5" style="margin-right: 10px;">
                            20 jóvenes
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q5" style="margin-right: 10px;">
                            22 jóvenes
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q5" style="margin-right: 10px;">
                            25 jóvenes
                        </label>
                    </div>
                    
                    <div class="question">
                        <h4>2. ¿Cuál fue una de las principales innovaciones pedagógicas del campamento?</h4>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q6" style="margin-right: 10px;">
                            El sistema de patrullas y la educación por la acción
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q6" style="margin-right: 10px;">
                            Las clases magistrales al aire libre
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q6" style="margin-right: 10px;">
                            La disciplina militar estricta
                        </label>
                    </div>

                    <button class="btn" onclick="checkQuiz(4, 2)" id="checkBtn-4">Verificar Respuestas</button>
                    <button class="btn hidden" onclick="completeModule(4)" id="nextBtn-4">Continuar a Expansión Mundial 🌍</button>
                </div>
            </div>

            <!-- MÓDULO 5: EXPANSIÓN MUNDIAL -->
            <div class="module" id="module-5">
                <h2>🌍 Expansión Mundial del Escultismo</h2>
                
                <div class="badge">Módulo 4/6</div>
                
                <h3>📚 "Escultismo para Muchachos" (1908)</h3>
                <p>Basándose en el éxito de Brownsea, Baden-Powell escribió este manual revolucionario que se convertiría en <strong>el cuarto libro más vendido de la historia</strong>. Fue publicado en fascículos quincenales y rápidamente se extendió por todo el mundo.</p>

                <h3>🚀 Crecimiento Exponencial</h3>
                <div class="timeline">
                    <div class="timeline-item">
                        <h4>1908 - Reino Unido</h4>
                        <p>Primeras patrullas scouts espontáneas. En pocos meses había miles de jóvenes scouts organizándose por sí mismos.</p>
                    </div>
                    <div class="timeline-item">
                        <h4>1910 - Primer Rally</h4>
                        <p>Crystal Palace, Londres. 11,000 scouts de todo Reino Unido se reúnen, incluyendo a las primeras Girl Guides.</p>
                    </div>
                    <div class="timeline-item">
                        <h4>1920 - Primer Jamboree Mundial</h4>
                        <p>Olimpia, Londres. 8,000 scouts de 34 países. Baden-Powell es proclamado Jefe Scout Mundial.</p>
                    </div>
                    <div class="timeline-item">
                        <h4>1925 - América Latina</h4>
                        <p>El escultismo llega fuertemente a Argentina, Chile, Brasil y se extiende por todo el continente.</p>
                    </div>
                </div>

                <h3>🇨🇴 Llegada a Colombia</h3>
                <p>El escultismo llega a Colombia en la década de 1920, estableciéndose firmemente como un movimiento educativo que ha formado a <strong>miles de jóvenes colombianos</strong> en valores de servicio, liderazgo y ciudadanía activa.</p>

                <div class="info-box">
                    <strong>🌟 Dato Impresionante:</strong><br>
                    Hoy el escultismo está presente en <strong>216 países y territorios</strong>, con más de <strong>57 millones de miembros</strong>, siendo el mayor movimiento educativo juvenil del mundo.
                </div>

                <div class="reflection-area">
                    <h4>🤔 Reflexión Personal</h4>
                    <p>¿Cómo crees que el escultismo ha impactado en el desarrollo de Colombia? ¿Qué rol pueden jugar los rovers hoy en la construcción de un país mejor?</p>
                    <textarea id="reflection-5" placeholder="Escribe tu reflexión aquí..." onchange="saveReflection(5, this.value)"></textarea>
                </div>

                <div class="quiz-container">
                    <h3>🔍 Evaluación - Expansión Mundial</h3>
                    <div class="question">
                        <h4>1. ¿En qué año se publicó "Escultismo para Muchachos"?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q7" style="margin-right: 10px;">
                            1907
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q7" style="margin-right: 10px;">
                            1908
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q7" style="margin-right: 10px;">
                            1910
                        </label>
                    </div>
                    
                    <div class="question">
                        <h4>2. ¿Cuántos scouts hay aproximadamente en el mundo actualmente?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q8" style="margin-right: 10px;">
                            45 millones
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q8" style="margin-right: 10px;">
                            57 millones
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q8" style="margin-right: 10px;">
                            70 millones
                        </label>
                    </div>

                    <button class="btn" onclick="checkQuiz(5, 2)" id="checkBtn-5">Verificar Respuestas</button>
                    <button class="btn hidden" onclick="completeModule(5)" id="nextBtn-5">Continuar al Método Scout ⚙️</button>
                </div>
            </div>

            <!-- MÓDULO 6: MÉTODO SCOUT CORREGIDO -->
            <div class="module" id="module-6">
                <h2>⚙️ El Método Scout y sus Componentes</h2>
                
                <div class="badge">Módulo 5/6</div>
                
                <h3>🎯 ¿Qué es el Método Scout?</h3>
                <p>El Método Scout es un <strong>sistema educativo original</strong> que promueve la <strong>autoeducación, el empoderamiento y el aprendizaje cooperativo</strong>. Es el corazón del movimiento scout y lo que nos diferencia de otras organizaciones juveniles.</p>

                <h3>🎪 Los 8 Elementos del Método Scout</h3>
                <p>Según la Asociación Scout de Colombia, el Método Scout funciona como un <strong>sistema integrado</strong> de 8 elementos que trabajan juntos:</p>

                <div class="method-grid">
                    <div class="method-element" style="background: linear-gradient(135deg, #e8f5e8, #c8e6c8); border-color: #28a745;">
                        <h4>1. 🤝 Adhesión a la Ley y Promesa Scout</h4>
                        <p>Compromiso personal libre y voluntario con los valores scouts expresados en la Ley y la Promesa.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); border-color: #2196f3;">
                        <h4>2. 📈 Aprendizaje por la Acción</h4>
                        <p>Educación a través de la experiencia práctica, el hacer y el descubrir. Los jóvenes aprenden haciendo, no solo escuchando.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #fff3e0, #ffe0b2); border-color: #ff9800;">
                        <h4>3. 👥 Sistema de Equipos</h4>
                        <p>Pequeños grupos que facilitan el desarrollo personal y social a través de la interacción, cooperación y amistad entre pares.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #fce4ec, #f8bbd9); border-color: #e91e63;">
                        <h4>4. 🎯 Sistema Progresivo de Objetivos y Actividades</h4>
                        <p>Desarrollo gradual mediante objetivos educativos apropiados a cada edad y actividades atractivas y desafiantes.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #f3e5f5, #e1bee7); border-color: #9c27b0;">
                        <h4>5. 🎭 Marco Simbólico</h4>
                        <p>Ambiente imaginativo y simbólico que motiva, da sentido de pertenencia y es apropiado para cada edad.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #e0f2f1, #b2dfdb); border-color: #009688;">
                        <h4>6. 🌲 Vida en la Naturaleza</h4>
                        <p>Contacto directo con el ambiente natural como espacio privilegiado de educación y desarrollo personal.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #fff8e1, #ffecb3); border-color: #ffc107;">
                        <h4>7. 🤗 Presencia Estimulante del Adulto</h4>
                        <p>Acompañamiento de adultos preparados que facilitan y apoyan el proceso educativo sin imponer ni substituir.</p>
                    </div>
                    
                    <div class="method-element" style="background: linear-gradient(135deg, #ffebee, #ffcdd2); border-color: #f44336;">
                        <h4>8. 🌍 Involucramiento Comunitario</h4>
                        <p>Participación activa de los jóvenes en su comunidad, desarrollando conciencia social y compromiso ciudadano a través del servicio a los demás.</p>
                    </div>
                </div>

                <h3>🔗 La Integración es Clave</h3>
                <p>Estos componentes <strong>NO funcionan por separado</strong>. Su poder educativo radica en cómo <strong>interactúan entre sí</strong> para crear un entorno educativo dinámico, entretenido, enriquecedor y seguro.</p>

                <div class="info-box">
                    <strong>💡 Principio Fundamental:</strong><br>
                    El método scout es más que la suma de sus partes. Cada componente refuerza y potencia a los demás, creando una experiencia educativa única y transformadora.
                </div>

                <div class="reflection-area">
                    <h4>🤔 Reflexión Personal</h4>
                    <p>¿Cuál de los 8 elementos has experimentado más fuertemente en tu vida scout? ¿Cómo aplicarías todos estos elementos de manera integrada con los niños y niñas que acompañarás?</p>
                    <textarea id="reflection-6" placeholder="Escribe tu reflexión aquí..." onchange="saveReflection(6, this.value)"></textarea>
                </div>

                <div class="quiz-container">
                    <h3>🔍 Evaluación - Método Scout</h3>
                    <div class="question">
                        <h4>1. ¿Cuántos elementos tiene el Método Scout según la ASC?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q9" style="margin-right: 10px;">
                            7 elementos
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q9" style="margin-right: 10px;">
                            8 elementos integrados
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q9" style="margin-right: 10px;">
                            5 elementos básicos
                        </label>
                    </div>
                    
                    <div class="question">
                        <h4>2. ¿Cuál es la característica principal del funcionamiento del Método Scout?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q10" style="margin-right: 10px;">
                            Los 8 elementos funcionan independientemente
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q10" style="margin-right: 10px;">
                            Los 8 elementos interactúan como un sistema integrado
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q10" style="margin-right: 10px;">
                            Se enfoca únicamente en actividades al aire libre
                        </label>
                    </div>

                    <button class="btn" onclick="checkQuiz(6, 2)" id="checkBtn-6">Verificar Respuestas</button>
                    <button class="btn hidden" onclick="completeModule(6)" id="nextBtn-6">Continuar al Impacto Social 🎯</button>
                </div>
            </div>

            <!-- MÓDULO 7: IMPACTO SOCIAL -->
            <div class="module" id="module-7">
                <h2>🎯 Impacto Social y Ciudadanía Global</h2>
                
                <div class="badge">Módulo 6/6</div>
                
                <h3>🌍 El Mayor Movimiento Educativo Juvenil del Mundo</h3>
                <p>Con más de <strong>57 millones de miembros</strong> en <strong>216 países y territorios</strong>, el escultismo es una fuerza global para el bien que forma ciudadanos activos y comprometidos.</p>

                <div class="stats">
                    <div class="stat-card">
                        <h4>57M+</h4>
                        <p>Scouts en el mundo</p>
                    </div>
                    <div class="stat-card">
                        <h4>216</h4>
                        <p>Países y territorios</p>
                    </div>
                    <div class="stat-card">
                        <h4>115+</h4>
                        <p>Años de impacto</p>
                    </div>
                    <div class="stat-card">
                        <h4>∞</h4>
                        <p>Vidas transformadas</p>
                    </div>
                </div>

                <h3>🇨🇴 Tu Rol como Rover Colombiano</h3>
                <p>Como rover en Colombia, tienes la oportunidad única de:</p>
                <ul>
                    <li><strong>Ser mentor</strong> de las nuevas generaciones scouts</li>
                    <li><strong>Liderar proyectos</strong> de impacto social en tu comunidad</li>
                    <li><strong>Conectar el escultismo local</strong> con desafíos globales</li>
                    <li><strong>Formar redes</strong> de jóvenes comprometidos con el cambio</li>
                    <li><strong>Prepararte</strong> para ser un líder transformacional del mañana</li>
                    <li><strong>Contribuir</strong> a la paz y el desarrollo sostenible de Colombia</li>
                </ul>

                <div class="mission-box">
                    <h3>🎯 Tu Misión como Sinodal/Ayudante</h3>
                    <p>Al convertirte en sinodal/ayudante, no solo apoyas a niños y niñas en su crecimiento personal, sino que <strong>perpetúas un legado de 115+ años</strong> de formación de ciudadanos comprometidos con construir un mundo mejor. Eres el eslabón que conecta el pasado heroico del escultismo con el futuro prometedor de Colombia.</p>
                </div>

                <div class="reflection-area">
                    <h4>🤔 Reflexión Final</h4>
                    <p>¿Cómo vas a utilizar todo lo que has aprendido para impactar positivamente a los niños y niñas que acompañarás? ¿Qué tipo de líder y mentor quieres ser?</p>
                    <textarea id="reflection-7" placeholder="Escribe tu reflexión aquí..." onchange="saveReflection(7, this.value)"></textarea>
                </div>

                <div class="quiz-container">
                    <h3>🔍 Evaluación Final</h3>
                    <div class="question">
                        <h4>1. ¿Cuál es el rol principal de un rover como sinodal/ayudante?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q11" style="margin-right: 10px;">
                            Supervisar estrictamente a los niños y corregir errores
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q11" style="margin-right: 10px;">
                            Ser mentor, perpetuar el legado scout y formar ciudadanos comprometidos
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q11" style="margin-right: 10px;">
                            Organizar únicamente actividades deportivas y de entretenimiento
                        </label>
                    </div>
                    
                    <div class="question">
                        <h4>2. ¿Cuántos años de historia tiene el movimiento scout?</h4>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q12" style="margin-right: 10px;">
                            100 años
                        </label>
                        <label class="option" onclick="selectOption(this, true)">
                            <input type="radio" name="q12" style="margin-right: 10px;">
                            Más de 115 años
                        </label>
                        <label class="option" onclick="selectOption(this, false)">
                            <input type="radio" name="q12" style="margin-right: 10px;">
                            80 años
                        </label>
                    </div>

                    <button class="btn" onclick="checkQuiz(7, 2)" id="checkBtn-7">Verificar Respuestas</button>
                    <button class="btn hidden" onclick="completeModule(7)" id="nextBtn-7">Obtener Certificado 🏆</button>
                </div>
            </div>

            <!-- MÓDULO 8: CERTIFICADO -->
            <div class="module" id="module-8">
                <div class="certificate">
                    <h2>🏆 ¡FELICITACIONES!</h2>
                    <h3>Certificado de Completación</h3>
                    <h2 style="color: #1a4b6b; margin: 20px 0;">FUNDAMENTOS DEL MOVIMIENTO SCOUT</h2>
                    
                    <p style="font-size: 1.1rem; margin: 20px 0;">Certificamos que</p>
                    <h3 style="color: #ffc107; font-size: 1.8rem; margin: 15px 0;" id="studentName"></h3>
                    <p style="margin: 20px 0;">ha completado exitosamente el curso de <strong>Historia y Características Esenciales del Movimiento Scout</strong>, demostrando comprensión profunda de los fundamentos necesarios para servir como sinodal/ayudante en las ramas de manada y tropa.</p>
                    
                    <div style="display: flex; justify-content: space-between; margin-top: 30px; font-size: 0.9rem;">
                        <div>
                            <p><strong>Fecha:</strong> <span id="certDate"></span></p>
                            <p><strong>Duración:</strong> <span id="totalTime"></span> minutos</p>
                            <p><strong>Grupo Scout:</strong> <span id="certGroup"></span></p>
                        </div>
                        <div>
                            <p><strong>Puntuación:</strong> <span id="finalScore"></span>%</p>
                            <p><strong>Estado:</strong> APROBADO ✅</p>
                            <p><strong>Región:</strong> <span id="certRegion"></span></p>
                        </div>
                    </div>
                </div>

                <h3>🏆 Logros Desbloqueados</h3>
                <div class="achievements">
                    <div class="achievement earned">📚 Historiador Scout</div>
                    <div class="achievement earned">🎯 Conocedor de la Misión</div>
                    <div class="achievement earned">⚙️ Metodólogo Scout</div>
                    <div class="achievement earned">🌍 Ciudadano Global</div>
                    <div class="achievement earned">🎓 Rover Certificado</div>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn" onclick="downloadCertificatePDF()">📄 Descargar Certificado PDF</button>
                    <button class="btn" onclick="shareResults()">📤 Compartir Logros</button>
                    <button class="btn" onclick="restartCourse()">🔄 Reiniciar Curso</button>
                </div>

                <div class="reflection-area">
                    <h4>🎯 Compromiso Personal</h4>
                    <p>Escribe tu compromiso como rover certificado para servir a las nuevas generaciones scouts:</p>
                    <textarea id="commitment" placeholder="Mi compromiso como rover scout certificado es..." onchange="saveCommitment(this.value)"></textarea>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentModule = 0;
        let moduleProgress = [false, false, false, false, false, false, false, false];
        let quizScores = [];
        let startTime = new Date();
        let studyTime = 0;
        let reflections = {};
        let userProfile = {};

        // Función de registro corregida con manejo de errores
        function handleRegistration(event) {
            event.preventDefault();
            console.log('Formulario enviado');
            
            try {
                const formData = new FormData(event.target);
                userProfile = {
                    fullName: formData.get('fullName'),
                    age: formData.get('age'),
                    group: formData.get('group'),
                    region: formData.get('region'),
                    email: formData.get('email'),
                    motivation: formData.get('motivation'),
                    registrationDate: new Date().toISOString()
                };
                
                console.log('Datos del usuario:', userProfile);
                
                // Validación mejorada
                if (!userProfile.fullName || userProfile.fullName.trim() === '') {
                    alert('El nombre completo es requerido para continuar.');
                    return;
                }
                
                // Guardar progreso con manejo de errores
                try {
                    saveProgress();
                    console.log('Progreso guardado exitosamente');
                } catch (saveError) {
                    console.error('Error guardando progreso:', saveError);
                    // Continuar sin guardar si hay error
                }
                
                // Mostrar módulo 1
                showModule(1);
                
                // Actualizar nombre de bienvenida con verificación
                const welcomeElement = document.getElementById('welcomeName');
                if (welcomeElement) {
                    const firstName = userProfile.fullName.split(' ')[0];
                    welcomeElement.textContent = firstName;
                } else {
                    console.error('Elemento welcomeName no encontrado');
                }
                
                // Mostrar notificación
                const firstName = userProfile.fullName.split(' ')[0];
                showNotification('¡Registro exitoso! Bienvenido/a ' + firstName + ' al curso.');
                
            } catch (error) {
                console.error('Error en handleRegistration:', error);
                alert('Hubo un error al procesar el registro. Por favor, inténtalo de nuevo.');
            }
        }

        // Función saveProgress mejorada
        function saveProgress() {
            try {
                const progress = {
                    userProfile: userProfile || {},
                    moduleProgress: moduleProgress || [false, false, false, false, false, false, false, false],
                    quizScores: quizScores || [],
                    studyTime: studyTime || 0,
                    reflections: reflections || {},
                    currentModule: currentModule || 0,
                    startTime: startTime ? startTime.toISOString() : new Date().toISOString()
                };
                
                localStorage.setItem('scoutCourseProgress', JSON.stringify(progress));
                console.log('Progreso guardado:', progress);
                return true;
            } catch (error) {
                console.error('Error guardando en localStorage:', error);
                return false;
            }
        }

        // Función showModule mejorada
        function showModule(moduleIndex) {
            console.log('Mostrando módulo:', moduleIndex);
            
            try {
                // Verificar si está registrado para módulos > 0
                if (moduleIndex > 0 && (!userProfile || !userProfile.fullName || userProfile.fullName.trim() === '')) {
                    alert('Debes completar el registro antes de continuar.');
                    return;
                }
                
                // Ocultar todos los módulos
                document.querySelectorAll('.module').forEach(module => {
                    module.classList.remove('active');
                });
                
                // Mostrar el módulo seleccionado
                const targetModule = document.getElementById(`module-${moduleIndex}`);
                if (targetModule) {
                    targetModule.classList.add('active');
                } else {
                    console.error('No se encontró el módulo:', moduleIndex);
                    return;
                }
                
                // Actualizar navegación
                document.querySelectorAll('.nav-btn').forEach((btn, index) => {
                    btn.classList.remove('active');
                    if (index === moduleIndex) {
                        btn.classList.add('active');
                    }
                });
                
                currentModule = moduleIndex;
                
                // Si es el certificado, generar datos finales
                if (moduleIndex === 8) {
                    generateCertificate();
                }
                
                updateProgress();
                
            } catch (error) {
                console.error('Error en showModule:', error);
                alert('Error al cambiar de módulo. Por favor, recarga la página.');
            }
        }

        // Gestión de quiz
        function selectOption(element, isCorrect) {
            try {
                // Remover selección previa en la misma pregunta
                const question = element.closest('.question');
                question.querySelectorAll('.option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Marcar como seleccionada
                element.classList.add('selected');
                element.setAttribute('data-correct', isCorrect);
            } catch (error) {
                console.error('Error en selectOption:', error);
            }
        }

        function checkQuiz(moduleNum, totalQuestions) {
            try {
                const questions = document.querySelectorAll(`#module-${moduleNum} .question`);
                let correctAnswers = 0;
                
                questions.forEach(question => {
                    const selectedOption = question.querySelector('.option.selected');
                    if (selectedOption) {
                        const isCorrect = selectedOption.getAttribute('data-correct') === 'true';
                        if (isCorrect) {
                            selectedOption.classList.add('correct');
                            correctAnswers++;
                        } else {
                            selectedOption.classList.add('incorrect');
                            // Mostrar la respuesta correcta
                            const correctOption = question.querySelector('.option[data-correct="true"]');
                            if (correctOption) correctOption.classList.add('correct');
                        }
                    }
                });
                
                const score = (correctAnswers / totalQuestions) * 100;
                quizScores[moduleNum - 2] = score; // Ajuste porque el primer quiz es del módulo 2
                
                // Mostrar resultado
                const checkBtn = document.getElementById(`checkBtn-${moduleNum}`);
                const nextBtn = document.getElementById(`nextBtn-${moduleNum}`);
                
                if (checkBtn) checkBtn.style.display = 'none';
                
                if (score >= 70) {
                    if (nextBtn) nextBtn.classList.remove('hidden');
                    // Unlock achievements
                    if (moduleNum === 2) unlockAchievement('achievement-2');
                    if (moduleNum === 3) unlockAchievement('achievement-1');
                    if (moduleNum === 6) unlockAchievement('achievement-3');
                    if (moduleNum === 7) unlockAchievement('achievement-4');
                } else {
                    alert(`Puntuación: ${score}%. Necesitas al menos 70% para continuar. Revisa el contenido y vuelve a intentar.`);
                    setTimeout(() => location.reload(), 2000);
                }
                
                saveProgress();
            } catch (error) {
                console.error('Error en checkQuiz:', error);
                alert('Error al verificar el quiz. Por favor, inténtalo de nuevo.');
            }
        }

        // Completar módulo
        function completeModule(moduleNum) {
            try {
                moduleProgress[moduleNum - 1] = true;
                
                // Marcar navegación como completada
                const navBtns = document.querySelectorAll('.nav-btn');
                if (navBtns[moduleNum]) navBtns[moduleNum].classList.add('completed');
                
                // Mostrar siguiente módulo
                showModule(moduleNum + 1);
                
                saveProgress();
                updateProgress();
                updateStats();
            } catch (error) {
                console.error('Error en completeModule:', error);
            }
        }

        // Actualizar progreso
        function updateProgress() {
            try {
                const completedModules = moduleProgress.filter(Boolean).length;
                const progressPercent = (completedModules / 6) * 100; // 6 módulos educativos
                
                const progressBar = document.getElementById('progressBar');
                const progressText = document.getElementById('progressText');
                const timeRemaining = document.getElementById('timeRemaining');
                
                if (progressBar) progressBar.style.width = progressPercent + '%';
                if (progressText) progressText.textContent = Math.round(progressPercent) + '%';
                
                // Actualizar tiempo estimado
                const remainingModules = 6 - completedModules;
                const estimatedTime = remainingModules * 50; // 50 minutos por módulo
                if (timeRemaining) timeRemaining.textContent = estimatedTime + ' minutos';
            } catch (error) {
                console.error('Error en updateProgress:', error);
            }
        }

        // Actualizar estadísticas
        function updateStats() {
            try {
                const completedModules = moduleProgress.filter(Boolean).length;
                const completedQuizzes = quizScores.filter(score => score >= 70).length;
                
                const modulesElement = document.getElementById('modulesCompleted');
                const quizzesElement = document.getElementById('quizzesCompleted');
                const timeElement = document.getElementById('studyTime');
                
                if (modulesElement) modulesElement.textContent = completedModules;
                if (quizzesElement) quizzesElement.textContent = completedQuizzes;
                if (timeElement) timeElement.textContent = studyTime;
            } catch (error) {
                console.error('Error en updateStats:', error);
            }
        }

        // Desbloquear logro
        function unlockAchievement(achievementId) {
            try {
                const achievement = document.getElementById(achievementId);
                if (achievement) {
                    achievement.classList.add('earned');
                    showNotification(`¡Logro desbloqueado: ${achievement.textContent}!`);
                }
            } catch (error) {
                console.error('Error en unlockAchievement:', error);
            }
        }

        // Mostrar notificación
        function showNotification(message) {
            try {
                const notification = document.createElement('div');
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #28a745;
                    color: white;
                    padding: 15px 20px;
                    border-radius: 5px;
                    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
                    z-index: 1000;
                    animation: slideIn 0.3s ease;
                    max-width: 300px;
                `;
                notification.textContent = message;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }, 3000);
            } catch (error) {
                console.error('Error en showNotification:', error);
            }
        }

        // Generar certificado
        function generateCertificate() {
            try {
                const studentNameElement = document.getElementById('studentName');
                const certDateElement = document.getElementById('certDate');
                const totalTimeElement = document.getElementById('totalTime');
                const certGroupElement = document.getElementById('certGroup');
                const certRegionElement = document.getElementById('certRegion');
                const finalScoreElement = document.getElementById('finalScore');
                
                if (studentNameElement) studentNameElement.textContent = userProfile.fullName || 'Rover Scout';
                if (certDateElement) certDateElement.textContent = new Date().toLocaleDateString('es-CO');
                if (totalTimeElement) totalTimeElement.textContent = studyTime;
                if (certGroupElement) certGroupElement.textContent = userProfile.group || 'N/A';
                if (certRegionElement) certRegionElement.textContent = userProfile.region || 'Colombia';
                
                const avgScore = quizScores.length > 0 ? quizScores.reduce((a, b) => a + b, 0) / quizScores.length : 100;
                if (finalScoreElement) finalScoreElement.textContent = Math.round(avgScore);
                
                // Desbloquear logro final
                unlockAchievement('achievement-5');
                
                // Actualizar progreso a 100%
                const progressBar = document.getElementById('progressBar');
                const progressText = document.getElementById('progressText');
                
                if (progressBar) progressBar.style.width = '100%';
                if (progressText) progressText.textContent = '100%';
            } catch (error) {
                console.error('Error en generateCertificate:', error);
            }
        }

        // Descargar certificado PDF
        function downloadCertificatePDF() {
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF();
                
                // Configurar el PDF
                pdf.setFontSize(20);
                pdf.text('CERTIFICADO DE COMPLETACION', 20, 30);
                
                pdf.setFontSize(16);
                pdf.text('FUNDAMENTOS DEL MOVIMIENTO SCOUT', 20, 50);
                
                pdf.setFontSize(12);
                pdf.text(`Certificamos que ${userProfile.fullName || 'Rover Scout'}`, 20, 80);
                pdf.text('ha completado exitosamente el curso de Historia y', 20, 95);
                pdf.text('Caracteristicas Esenciales del Movimiento Scout', 20, 110);
                
                pdf.text(`Fecha: ${new Date().toLocaleDateString('es-CO')}`, 20, 140);
                pdf.text(`Grupo Scout: ${userProfile.group || 'N/A'}`, 20, 155);
                pdf.text(`Region: ${userProfile.region || 'Colombia'}`, 20, 170);
                pdf.text(`Tiempo de estudio: ${studyTime} minutos`, 20, 185);
                
                const avgScore = quizScores.length > 0 ? Math.round(quizScores.reduce((a, b) => a + b, 0) / quizScores.length) : 100;
                pdf.text(`Puntuacion promedio: ${avgScore}%`, 20, 200);
                
                pdf.setFontSize(10);
                pdf.text('ASOCIACION SCOUT DE COLOMBIA', 20, 230);
                pdf.text('Programa de Formacion Rama Rover', 20, 245);
                
                // Descargar el PDF
                pdf.save(`Certificado_${userProfile.fullName?.replace(/\s+/g, '_') || 'Rover'}_Fundamentos_Scout.pdf`);
                showNotification("¡Certificado PDF descargado exitosamente!");
            } catch (error) {
                showNotification("Generando certificado de texto. Puedes hacer captura de pantalla del certificado en pantalla.");
                console.error('Error generando PDF:', error);
            }
        }

        // Compartir resultados
        function shareResults() {
            try {
                const name = userProfile.fullName || 'Rover Scout';
                const group = userProfile.group || 'Grupo Scout';
                const text = `¡He completado el Curso de Fundamentos Scout! 🏕️

👤 ${name}
🏕️ ${group}
✅ 6/6 Módulos completados
⏱️ ${studyTime} minutos de estudio
🎯 Listo para ser sinodal/ayudante

#ScoutsSiempreListos #RoverScout #ASC`;
                
                if (navigator.share) {
                    navigator.share({
                        title: 'Curso Fundamentos Scout Completado',
                        text: text
                    });
                } else {
                    navigator.clipboard.writeText(text).then(() => {
                        showNotification("¡Texto copiado al portapapeles para compartir!");
                    }).catch(() => {
                        showNotification("Texto para compartir preparado");
                    });
                }
            } catch (error) {
                console.error('Error en shareResults:', error);
            }
        }

        // Reiniciar curso
        function restartCourse() {
            if (confirm("¿Estás seguro de que quieres reiniciar el curso? Se perderá todo el progreso.")) {
                localStorage.removeItem('scoutCourseProgress');
                localStorage.removeItem('scoutCommitment');
                location.reload();
            }
        }

        // Guardar reflexión
        function saveReflection(moduleNum, text) {
            try {
                reflections[moduleNum] = text;
                saveProgress();
            } catch (error) {
                console.error('Error en saveReflection:', error);
            }
        }

        // Guardar compromiso
        function saveCommitment(text) {
            try {
                localStorage.setItem('scoutCommitment', text);
            } catch (error) {
                console.error('Error en saveCommitment:', error);
            }
        }

        // Cargar progreso
        function loadProgress() {
            try {
                const saved = localStorage.getItem('scoutCourseProgress');
                if (saved) {
                    const progress = JSON.parse(saved);
                    userProfile = progress.userProfile || {};
                    moduleProgress = progress.moduleProgress || [false, false, false, false, false, false, false, false];
                    quizScores = progress.quizScores || [];
                    studyTime = progress.studyTime || 0;
                    reflections = progress.reflections || {};
                    currentModule = progress.currentModule || 0;
                    startTime = new Date(progress.startTime) || new Date();
                    
                    console.log('Progreso cargado:', progress);
                    
                    // Si hay perfil guardado, saltar registro
                    if (userProfile.fullName && userProfile.fullName.trim() !== '' && currentModule === 0) {
                        showModule(1);
                        const firstName = userProfile.fullName.split(' ')[0];
                        const welcomeElement = document.getElementById('welcomeName');
                        if (welcomeElement) welcomeElement.textContent = firstName;
                    }
                    
                    // Restaurar reflexiones
                    Object.keys(reflections).forEach(key => {
                        const textarea = document.getElementById(`reflection-${key}`);
                        if (textarea) textarea.value = reflections[key];
                    });
                    
                    updateStats();
                    updateProgress();
                }
            } catch (error) {
                console.error('Error cargando progreso:', error);
            }
        }

        // Inicialización
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM cargado');
            loadProgress();
            
            // Timer para tiempo de estudio
            setInterval(() => {
                if (currentModule > 0) { // Solo contar tiempo después del registro
                    studyTime += 1;
                    updateStats();
                    if (studyTime % 5 === 0) { // Guardar cada 5 minutos
                        saveProgress();
                    }
                }
            }, 60000); // Actualizar cada minuto
        });
    </script>
</body>
</html>